<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, viewport-fit=cover"
  />
  <title>FWEA-I Omnilingual Clean Version Editor | Professional Audio Cleaning</title>
  <meta
    name="description"
    content="Professional omnilingual audio profanity removal tool for DJs, artists, and content creators. Clean audio in 100+ languages with AI-powered precision."
  />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet"
  />
  <!-- Stripe -->
  <script src="https://js.stripe.com/v3/"></script>

  <!-- ===========================
       CSS (Full Page Styles)
       =========================== -->
  <style>
    :root {
      /* Primary Brand Colors */
      --primary-bg: #0a0a0a;
      --secondary-bg: #121212;
      --surface-bg: #1a1a1a;
      --glass-bg: rgba(255, 255, 255, 0.05);
      --glass-border: rgba(255, 255, 255, 0.1);

      /* Accent Colors */
      --electric-blue: #00d4ff;
      --teal-green: #00ff88;
      --soft-purple: #a855f7;
      --sandy-tone: #f5deb3;
      --accent-gradient: linear-gradient(135deg, var(--electric-blue), var(--teal-green));
      --purple-gradient: linear-gradient(135deg, var(--soft-purple), var(--electric-blue));

      /* Text Colors */
      --text-primary: #ffffff;
      --text-secondary: #b3b3b3;
      --text-accent: var(--electric-blue);

      /* Status Colors */
      --success: var(--teal-green);
      --warning: #ffa500;
      --error: #ff4444;

      /* Typography */
      --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      --font-weight-light: 300;
      --font-weight-normal: 400;
      --font-weight-medium: 500;
      --font-weight-semibold: 600;
      --font-weight-bold: 700;
      --font-weight-extrabold: 800;

      /* Spacing */
      --space-xs: 0.25rem;
      --space-sm: 0.5rem;
      --space-md: 1rem;
      --space-lg: 1.5rem;
      --space-xl: 2rem;
      --space-2xl: 3rem;
      --space-3xl: 4rem;

      /* Border Radius */
      --radius-sm: 0.375rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --radius-xl: 1rem;
      --radius-2xl: 1.5rem;
      --radius-full: 9999px;

      /* Shadows */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      --shadow-glow: 0 0 20px rgba(0, 212, 255, 0.3);

      /* Transitions */
      --transition-fast: 150ms ease;
      --transition-normal: 300ms ease;
      --transition-slow: 500ms ease;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: var(--font-family);
      background: var(--primary-bg);
      color: var(--text-primary);
      line-height: 1.6;
      overflow-x: hidden;
      min-height: 100vh;
    }

    .glass {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-xl);
    }

    /* Header */
    .header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(10, 10, 10, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--glass-border);
      padding: var(--space-lg) 0;
    }
    .header-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 var(--space-lg);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo { display: flex; align-items: center; gap: var(--space-md); }
    .logo-icon {
      width: 48px; height: 48px;
      background: var(--accent-gradient);
      border-radius: var(--radius-lg);
      display: flex; align-items: center; justify-content: center;
      font-size: 1.5rem; font-weight: var(--font-weight-bold);
      color: var(--primary-bg);
    }
    .logo-text {
      font-size: 1.5rem;
      font-weight: var(--font-weight-extrabold);
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .logo-subtitle {
      font-size: 0.875rem; color: var(--text-secondary);
      font-weight: var(--font-weight-medium);
    }
    .nav { display: flex; gap: var(--space-xl); }
    .nav-link {
      color: var(--text-secondary);
      text-decoration: none;
      font-weight: var(--font-weight-medium);
      transition: var(--transition-fast);
      padding: var(--space-sm) var(--space-md);
      border-radius: var(--radius-md);
    }
    .nav-link:hover {
      color: var(--text-accent);
      background: rgba(0, 212, 255, 0.1);
    }

    /* Main Container */
    .main-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: var(--space-3xl) var(--space-lg);
    }

    /* Hero */
    .hero { text-align: center; margin-bottom: var(--space-3xl); }
    .hero-title {
      font-size: clamp(2.5rem, 5vw, 4rem);
      font-weight: var(--font-weight-extrabold);
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: var(--space-lg);
      line-height: 1.1;
    }
    .hero-subtitle {
      font-size: 1.25rem; color: var(--text-secondary);
      max-width: 600px; margin: 0 auto var(--space-xl);
      line-height: 1.6;
    }
    .hero-features {
      display: flex; justify-content: center; gap: var(--space-xl);
      flex-wrap: wrap; margin-bottom: var(--space-2xl);
    }
    .hero-feature {
      display: flex; align-items: center; gap: var(--space-sm);
      font-weight: var(--font-weight-medium); color: var(--teal-green);
    }
    .hero-feature-icon { font-size: 1.25rem; }

    /* Upload Section */
    .upload-section { margin-bottom: var(--space-3xl); }
    .upload-area {
      position: relative; padding: var(--space-3xl); text-align: center;
      border: 2px dashed var(--glass-border); border-radius: var(--radius-2xl);
      background: var(--glass-bg); backdrop-filter: blur(20px);
      transition: var(--transition-normal); cursor: pointer; overflow: hidden;
    }
    .upload-area::before {
      content: ''; position: absolute; top: -2px; left: -2px; right: -2px; bottom: -2px;
      background: var(--accent-gradient); border-radius: var(--radius-2xl);
      opacity: 0; transition: var(--transition-normal); z-index: -1;
    }
    .upload-area:hover::before, .upload-area.drag-over::before { opacity: 0.1; }
    .upload-area:hover, .upload-area.drag-over {
      border-color: var(--electric-blue);
      transform: translateY(-2px); box-shadow: var(--shadow-glow);
    }
    .upload-icon {
      font-size: 4rem; margin-bottom: var(--space-lg);
      background: var(--accent-gradient);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
      animation: pulse 2s infinite;
    }
    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.7} }
    .upload-title { font-size: 2rem; font-weight: var(--font-weight-bold); margin-bottom: var(--space-md); }
    .upload-subtitle { color: var(--text-secondary); margin-bottom: var(--space-xl); font-size: 1.125rem; }

    .supported-formats {
      display: flex; justify-content: center; gap: var(--space-md);
      margin: var(--space-xl) 0; flex-wrap: wrap;
    }
    .format-badge {
      padding: var(--space-sm) var(--space-md);
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid rgba(0, 255, 136, 0.3);
      border-radius: var(--radius-full);
      color: var(--teal-green); font-size: 0.875rem; font-weight: var(--font-weight-medium);
      transition: var(--transition-fast);
    }
    .format-badge:hover { background: rgba(0, 255, 136, 0.2); transform: translateY(-1px); }

    .upload-btn {
      background: var(--accent-gradient);
      border: none; padding: var(--space-lg) var(--space-2xl);
      border-radius: var(--radius-lg); color: var(--primary-bg);
      font-weight: var(--font-weight-bold); font-size: 1.125rem;
      cursor: pointer; transition: var(--transition-normal);
      display: inline-flex; align-items: center; gap: var(--space-md);
    }
    .upload-btn:hover { transform: translateY(-2px); box-shadow: var(--shadow-glow); }
    .file-input { display: none; }

    /* Processing Section */
    .processing-section { display: none; margin-bottom: var(--space-3xl); }
    .processing-card { padding: var(--space-2xl); text-align: center; }
    .processing-title { font-size: 1.5rem; font-weight: var(--font-weight-bold); margin-bottom: var(--space-lg); }
    .processing-status { color: var(--electric-blue); font-weight: var(--font-weight-medium); margin-bottom: var(--space-md); font-size: 1.125rem; }

    .language-detection {
      margin: var(--space-xl) 0; padding: var(--space-lg);
      background: rgba(168, 85, 247, 0.1);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(168, 85, 247, 0.2);
    }
    .detected-languages {
      display: flex; justify-content: center; gap: var(--space-sm);
      flex-wrap: wrap; margin-top: var(--space-md);
    }
    .language-tag {
      padding: var(--space-xs) var(--space-md);
      background: rgba(168, 85, 247, 0.2);
      border: 1px solid rgba(168, 85, 247, 0.3);
      border-radius: var(--radius-full);
      color: var(--soft-purple);
      font-size: 0.875rem; font-weight: var(--font-weight-medium);
      animation: fadeInUp 0.5s ease;
    }
    @keyframes fadeInUp { from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)} }

    /* Progress Bar */
    .progress-container { margin: var(--space-xl) 0; }
    .progress-stages { display: flex; justify-content: space-between; margin-bottom: var(--space-lg); position: relative; }
    .progress-stages::before {
      content: ''; position: absolute; top: 50%; left: 0; right: 0; height: 2px; background: var(--glass-border); z-index: 1;
    }
    .progress-line { position: absolute; top: 50%; left: 0; height: 2px; background: var(--accent-gradient); width: 0%; transition: var(--transition-slow); z-index: 2; }
    .stage { position: relative; z-index: 3; text-align: center; }
    .stage-dot {
      width: 16px; height: 16px; border-radius: 50%; background: var(--surface-bg);
      border: 2px solid var(--glass-border); margin: 0 auto var(--space-sm);
      transition: var(--transition-normal);
    }
    .stage.active .stage-dot, .stage.completed .stage-dot {
      background: var(--electric-blue); border-color: var(--electric-blue); box-shadow: 0 0 10px rgba(0,212,255,.5);
    }
    .stage-label { font-size: 0.75rem; color: var(--text-secondary); font-weight: var(--font-weight-medium); max-width: 80px; }
    .stage.active .stage-label, .stage.completed .stage-label { color: var(--electric-blue); }
    .progress-bar { height: 12px; background: var(--surface-bg); border-radius: var(--radius-full); overflow: hidden; position: relative; margin: var(--space-lg) 0; }
    .progress-fill { height: 100%; background: var(--accent-gradient); width: 0%; transition: var(--transition-slow); position: relative; }
    .progress-fill::after {
      content: ''; position: absolute; top: 0; left: 0; bottom: 0; right: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      animation: shimmer 2s infinite;
    }
    @keyframes shimmer { 0%{transform:translateX(-100%)} 100%{transform:translateX(100%)} }
    .progress-info { display: flex; justify-content: space-between; align-items: center; font-size: 0.875rem; }
    .progress-percentage { color: var(--electric-blue); font-weight: var(--font-weight-bold); }
    .time-remaining { color: var(--text-secondary); }

    /* Audio Player */
    .audio-player { display: none; margin-bottom: var(--space-3xl); }
    .player-card { padding: var(--space-2xl); }
    .player-title { font-size: 1.5rem; font-weight: var(--font-weight-bold); margin-bottom: var(--space-lg); text-align: center; }
    .waveform-container { background: var(--surface-bg); border-radius: var(--radius-lg); padding: var(--space-lg); margin-bottom: var(--space-lg); position: relative; overflow: hidden; }
    .waveform { width: 100%; height: 120px; background: linear-gradient(90deg, var(--electric-blue), var(--teal-green)); border-radius: var(--radius-md); position: relative; overflow: hidden; }
    .waveform::after {
      content: ''; position: absolute; inset: 0;
      background: repeating-linear-gradient(90deg, transparent 0px, transparent 2px, rgba(255,255,255,0.1) 2px, rgba(255,255,255,0.1) 4px);
      animation: waveAnimation 3s ease-in-out infinite;
    }
    @keyframes waveAnimation { 0%,100%{opacity:.3} 50%{opacity:.7} }
    .player-controls { display: flex; align-items: center; gap: var(--space-lg); justify-content: center; margin-bottom: var(--space-lg); }
    .play-btn {
      width: 60px; height: 60px; border-radius: 50%;
      background: var(--accent-gradient); border: none; color: var(--primary-bg);
      font-size: 1.5rem; cursor: pointer; transition: var(--transition-normal);
      display: flex; align-items: center; justify-content: center;
    }
    .play-btn:hover { transform: scale(1.05); box-shadow: var(--shadow-glow); }
    .time-display { font-family: 'Courier New', monospace; color: var(--text-secondary); font-size: 1.125rem; font-weight: var(--font-weight-medium); }
    .volume-control { display: flex; align-items: center; gap: var(--space-sm); }
    .volume-slider { width: 100px; height: 4px; background: var(--surface-bg); border-radius: var(--radius-full); outline: none; cursor: pointer; }

    .action-buttons { display: flex; justify-content: center; gap: var(--space-lg); flex-wrap: wrap; }
    .btn {
      padding: var(--space-md) var(--space-xl);
      border-radius: var(--radius-lg); border: none;
      font-weight: var(--font-weight-semibold); cursor: pointer; transition: var(--transition-normal);
      display: inline-flex; align-items: center; gap: var(--space-sm); font-size: 1rem;
    }
    .btn-secondary { background: var(--surface-bg); color: var(--text-primary); border: 1px solid var(--glass-border); }
    .btn-secondary:hover { background: var(--glass-bg); transform: translateY(-1px); }
    .btn-primary { background: var(--accent-gradient); color: var(--primary-bg); }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: var(--shadow-glow); }

    /* Pricing */
    .pricing-section { margin: var(--space-3xl) 0; }
    .pricing-title { text-align: center; font-size: 2.5rem; font-weight: var(--font-weight-bold); margin-bottom: var(--space-xl); background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .pricing-grid {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: var(--space-xl); max-width: 1200px; margin: 0 auto;
    }
    .pricing-card { padding: var(--space-2xl); text-align: center; position: relative; transition: var(--transition-normal); }
    .pricing-card:hover { transform: translateY(-4px); }
    .pricing-card.featured { border: 2px solid var(--electric-blue); box-shadow: var(--shadow-glow); }
    .pricing-badge {
      position: absolute; top: -12px; left: 50%; transform: translateX(-50%);
      background: var(--accent-gradient); color: var(--primary-bg);
      padding: var(--space-sm) var(--space-lg); border-radius: var(--radius-full);
      font-size: 0.875rem; font-weight: var(--font-weight-bold);
    }
    .pricing-tier { font-size: 1.25rem; font-weight: var(--font-weight-bold); margin-bottom: var(--space-md); text-align: center; }
    .pricing-price { font-size: 3rem; font-weight: var(--font-weight-extrabold); background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: var(--space-sm); text-align: center; }
    .pricing-period { color: var(--text-secondary); margin-bottom: var(--space-xl); text-align: center; }
    .pricing-features { list-style: none; margin-bottom: var(--space-xl); text-align: center; }
    .pricing-feature { padding: var(--space-sm) 0; display: flex; align-items: center; justify-content: center; gap: var(--space-sm); }
    .pricing-feature-icon { color: var(--teal-green); font-size: 1.125rem; }
    .pricing-btn { width: 100%; padding: var(--space-lg); font-size: 1.125rem; }

    /* Language Banner */
    .language-banner {
      position: fixed; bottom: 0; left: 0; right: 0; height: 60px;
      background: rgba(10,10,10,0.95); backdrop-filter: blur(20px);
      border-top: 1px solid var(--glass-border); z-index: 50; overflow: hidden;
    }
    .language-scroll {
      display: flex; align-items: center; height: 100%;
      animation: scroll-infinite 200s linear infinite; gap: var(--space-xl); white-space: nowrap;
    }
    @keyframes scroll-infinite { 0%{transform:translateX(0)} 100%{transform:translateX(-50%)} }
    .language-item {
      white-space: nowrap; font-weight: var(--font-weight-medium);
      padding: var(--space-sm) var(--space-md); border-radius: var(--radius-md);
      transition: var(--transition-fast); flex-shrink: 0;
    }
    .language-item:nth-child(4n+1){ color: var(--electric-blue); background: rgba(0,212,255,.1); }
    .language-item:nth-child(4n+2){ color: var(--teal-green); background: rgba(0,255,136,.1); }
    .language-item:nth-child(4n+3){ color: var(--soft-purple); background: rgba(168,85,247,.1); }
    .language-item:nth-child(4n+4){ color: var(--sandy-tone); background: rgba(245,222,179,.1); }

    /* Footer */
    .footer { margin-top: var(--space-3xl); padding: var(--space-2xl) var(--space-lg) 80px; text-align: center; border-top: 1px solid var(--glass-border); background: var(--surface-bg); }
    .footer-content { max-width: 1400px; margin: 0 auto; }
    .footer-copyright { color: var(--text-secondary); font-size: 0.875rem; margin-bottom: var(--space-md); }
    .footer-brand { background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: var(--font-weight-bold); }

    /* Animations / Utilities */
    @keyframes slideInRight { from{transform:translateX(100%); opacity:0} to{transform:translateX(0); opacity:1} }
    @keyframes fadeInOut { 0%,100%{opacity:0; transform:scale(.8)} 50%{opacity:.6; transform:scale(1)} }
    .premium-glow { box-shadow: 0 0 30px rgba(0, 212, 255, 0.3); border: 2px solid var(--electric-blue); }
    .conversion-highlight { animation: pulseGlow 2s infinite; }
    @keyframes pulseGlow { 0%,100%{ box-shadow: 0 0 20px rgba(0,212,255,.3)} 50%{ box-shadow: 0 0 40px rgba(0,212,255,.6)} }

    .hidden { display: none; }
    .fade-in { animation: fadeIn .5s ease; }
    @keyframes fadeIn { from{opacity:0} to{opacity:1} }
    .text-center { text-align: center; }
    .mb-0 { margin-bottom: 0; }

    /* Responsive */
    @media (max-width: 768px) {
      .main-container { padding: var(--space-xl) var(--space-md); }
      .hero-features { flex-direction: column; align-items: center; }
      .upload-area { padding: var(--space-xl); }
      .pricing-grid { grid-template-columns: 1fr; }
      .nav { display: none; }
      .header-container { padding: 0 var(--space-md); }
    }

    /* Admin overlay */
    .admin-mode .pricing-card { opacity: 0.5; pointer-events: none; }
    .admin-mode .pricing-card::after {
      content: 'ADMIN - FREE ACCESS';
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      background: var(--accent-gradient); color: var(--primary-bg);
      padding: var(--space-sm) var(--space-lg); border-radius: var(--radius-md);
      font-weight: var(--font-weight-bold); font-size: 0.875rem;
    }
  </style>
</head>

<body>
  <!-- Header -->
  <header class="header">
    <div class="header-container">
      <div class="logo">
        <div class="logo-icon">F</div>
        <div>
          <div class="logo-text">FWEA-I</div>
          <div class="logo-subtitle">Omnilingual Clean Version Editor</div>
        </div>
      </div>
      <nav class="nav">
        <a href="#features" class="nav-link">Features</a>
        <a href="#pricing" class="nav-link">Pricing</a>
        <a href="#languages" class="nav-link">Languages</a>
        <a href="#support" class="nav-link">Support</a>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <main class="main-container">
    <!-- Hero -->
    <section class="hero">
      <h1 class="hero-title">Professional Audio Cleaning<br />In 100+ Languages</h1>
      <p class="hero-subtitle">
        The world's most advanced omnilingual profanity removal tool. Perfect for DJs, artists, and content creators who demand pristine audio quality.
      </p>
      <div class="hero-features">
        <div class="hero-feature"><span class="hero-feature-icon">🌍</span><span>100+ Languages Supported</span></div>
        <div class="hero-feature"><span class="hero-feature-icon">🎯</span><span>AI-Powered Precision</span></div>
        <div class="hero-feature"><span class="hero-feature-icon">⚡</span><span>Lightning Fast Processing</span></div>
        <div class="hero-feature"><span class="hero-feature-icon">🔒</span><span>Studio-Grade Security</span></div>
      </div>
    </section>

    <!-- Upload Section -->
    <section class="upload-section">
      <div class="upload-area glass" id="uploadArea">
        <div class="upload-icon">🎵</div>
        <h2 class="upload-title">Drag & Drop Your Audio</h2>
        <p class="upload-subtitle">Upload your track and experience the future of audio cleaning</p>

        <div class="supported-formats">
          <span class="format-badge">MP3</span>
          <span class="format-badge">WAV</span>
          <span class="format-badge">FLAC</span>
          <span class="format-badge">M4A</span>
          <span class="format-badge">AAC</span>
          <span class="format-badge">OGG</span>
        </div>

        <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
          <span>📁</span> Choose Audio File
        </button>
        <input type="file" id="fileInput" class="file-input" accept="audio/*" multiple />
      </div>
    </section>

    <!-- Processing Section -->
    <section class="processing-section glass" id="processingSection">
      <div class="processing-card">
        <h3 class="processing-title">Processing Your Audio</h3>
        <div class="processing-status" id="processingStatus">Initializing AI engine...</div>

        <div class="language-detection" id="languageDetection">
          <div style="font-weight: 600; margin-bottom: 8px;">🔍 Detecting Languages:</div>
          <div class="detected-languages" id="detectedLanguages"></div>
        </div>

        <div class="progress-container">
          <div class="progress-stages">
            <div class="progress-line" id="progressLine"></div>
            <div class="stage" id="stage1"><div class="stage-dot"></div><div class="stage-label">Audio Analysis</div></div>
            <div class="stage" id="stage2"><div class="stage-dot"></div><div class="stage-label">Language Detection</div></div>
            <div class="stage" id="stage3"><div class="stage-dot"></div><div class="stage-label">Content Filtering</div></div>
            <div class="stage" id="stage4"><div class="stage-dot"></div><div class="stage-label">Audio Reconstruction</div></div>
            <div class="stage" id="stage5"><div class="stage-dot"></div><div class="stage-label">Quality Enhancement</div></div>
          </div>

          <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>

          <div class="progress-info">
            <span class="progress-percentage" id="progressPercentage">0%</span>
            <span class="time-remaining" id="timeRemaining">Estimated time: 2-3 minutes</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Audio Player -->
    <section class="audio-player glass" id="audioPlayer">
      <div class="player-card">
        <h3 class="player-title">🎉 Your Clean Audio is Ready!</h3>

        <div class="waveform-container"><div class="waveform" id="waveform"></div></div>

        <audio id="player" preload="metadata" style="width:100%; display:none;"></audio>

        <div class="player-controls">
          <button class="play-btn" id="playBtn">▶️</button>
          <span class="time-display" id="timeDisplay">0:00 / 0:30</span>
          <div class="volume-control">
            <span>🔊</span>
            <input type="range" class="volume-slider" min="0" max="100" value="80" oninput="document.getElementById('player').volume=Math.max(0,Math.min(1,this.value/100))" />
          </div>
        </div>

        <div class="action-buttons">
          <button class="btn btn-secondary" onclick="downloadPreview()"><span>⬇️</span> Download Preview</button>
          <button class="btn btn-primary" onclick="showPricingModal()"><span>💎</span> Get Full Version</button>
        </div>

        <div style="margin-top:24px; padding:16px; background:rgba(0,255,136,0.1); border-radius:12px; border:1px solid rgba(0,255,136,0.2);">
          <div style="font-weight:600; color:var(--teal-green); margin-bottom:8px;">✨ Processing Complete!</div>
          <div style="color:var(--text-secondary); font-size:0.875rem;">
            <span id="wordsRemoved">5</span> inappropriate words removed •
            <span id="languagesDetected">2</span> languages detected •
            Quality enhanced with AI
          </div>
        </div>
      </div>
    </section>

    <!-- Pricing -->
    <section class="pricing-section" id="pricing">
      <h2 class="pricing-title">Choose Your Plan</h2>
      <div class="pricing-grid">
        <!-- Single Track -->
        <div class="pricing-card glass">
          <div class="pricing-tier">Single Track</div>
          <div class="pricing-price">$4.99</div>
          <div class="pricing-period">per track</div>
          <ul class="pricing-features">
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>1 audio track cleaning</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>All 100+ languages</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>30-second preview</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>HD audio quality</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Instant download</span></li>
          </ul>
          <button class="btn btn-primary pricing-btn" onclick="purchaseTrack()">Get Single Track</button>
        </div>

        <!-- DJ Pro -->
        <div class="pricing-card glass featured">
          <div class="pricing-badge">Most Popular</div>
          <div class="pricing-tier">DJ Pro</div>
          <div class="pricing-price">$29.99</div>
          <div class="pricing-period">per month</div>
          <ul class="pricing-features">
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Unlimited track cleaning</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>All 100+ languages</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>30-second previews</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Priority processing</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Batch processing</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Professional support</span></li>
          </ul>
          <button class="btn btn-primary pricing-btn" onclick="purchaseDJPro()">Start DJ Pro</button>
        </div>

        <!-- Studio Elite -->
        <div class="pricing-card glass">
          <div class="pricing-tier">Studio Elite</div>
          <div class="pricing-price">$99.99</div>
          <div class="pricing-period">per month</div>
          <ul class="pricing-features">
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Everything in DJ Pro</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>60-second previews</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Studio-grade quality</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>API access</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Custom AI training</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Dedicated support</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Commercial licensing</span></li>
          </ul>
          <button class="btn btn-primary pricing-btn" onclick="purchaseStudioElite()">Start Studio Elite</button>
        </div>

        <!-- Day Pass -->
        <div class="pricing-card glass">
          <div class="pricing-tier">Day Pass</div>
          <div class="pricing-price">$9.99</div>
          <div class="pricing-period">24 hours</div>
          <ul class="pricing-features">
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Unlimited tracks (24h)</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>All 100+ languages</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>30-second previews</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>Batch processing</span></li>
            <li class="pricing-feature"><span class="pricing-feature-icon">✓</span><span>HD audio quality</span></li>
          </ul>
          <button class="btn btn-primary pricing-btn" onclick="purchaseDayPass()">Get Day Pass</button>
        </div>
      </div>
    </section>
  </main>

  <!-- Language Banner -->
  <div class="language-banner">
    <div class="language-scroll" id="languageScroll"></div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-copyright">
        © 2025 <span class="footer-brand">Fxckin With Everything Around - Intelligence</span>. All rights reserved.
      </div>
      <div style="color: var(--text-secondary); font-size: 0.75rem;">
        Professional audio cleaning technology • No refunds policy • Terms apply
      </div>
    </div>
  </footer>

  <!-- ===========================
       JavaScript (Your Full Rewrite)
       =========================== -->
  <script>
/* ===========================
   FWEA-I Frontend (Full Rewrite)
   =========================== */

///////////////////////
// Global Config
///////////////////////
const CONFIG = {
  STRIPE_PUBLISHABLE_KEY: 'pk_live_51RW06LJ2Iq1764pCr02p7yLia0VqBgUcRfG7Qm5OWFNAwFZcexIs9iBB3B9s22elcQzQjuAUMBxpeUhwcm8hsDf900NbCbF3Vw', // live key
  API_BASE_URL: 'https://omnibackend2.fweago-flavaz.workers.dev',                                           // worker url
  PREVIEW_DURATION: 30,
  STUDIO_PREVIEW_DURATION: 60,
  MAX_FILE_SIZE: 100 * 1024 * 1024,
  SUPPORTED_FORMATS: ['mp3', 'wav', 'flac', 'm4a', 'aac', 'ogg'],
  STRIPE_PRICES: {
    SINGLE_TRACK: 'price_1S4NnmJ2Iq1764pCjA9xMnrn',
    DJ_PRO: 'price_1S4NpzJ2Iq1764pCcZISuhug',
    STUDIO_ELITE: 'price_1S4Nr3J2Iq1764pCzHY4zIWr',
    DAY_PASS: 'price_1S4NsTJ2Iq1764pCCbru0Aao'
  },
  LANGUAGES: [
    'English','Haitian Creole','Spanish','French','German','Italian','Portuguese','Russian','Chinese','Japanese','Pidgin English','Korean',
    'Arabic','Hindi','Bengali','Turkish','Vietnamese','Thai','Yoruba','Igbo','Indonesian','Malay','Filipino','Hebrew',
    'Dutch','Swedish','Norwegian','Danish','Finnish','Polish','Czech','Hungarian','Romanian','Bulgarian',
    'Croatian','Serbian','Slovak','Slovenian','Estonian','Latvian','Lithuanian','Greek','Ukrainian','Belarusian',
    'Albanian','Macedonian','Bosnian','Montenegrin','Icelandic','Irish','Welsh','Scottish Gaelic','Breton','Basque',
    'Catalan','Galician','Luxembourgish','Maltese','Swahili','Hausa','Amharic','Somali',
    'Zulu','Xhosa','Afrikaans','Shona','Kikuyu','Luo','Kinyarwanda','Kirundi','Luganda','Wolof',
    'Bambara','Fula','Mandinka','Akan','Ewe','Ga','Twi','Fante','Dagbani','Kasem',
    'Urdu','Punjabi','Sindhi','Pashto','Dari','Farsi','Tajik','Uzbek','Kazakh','Kyrgyz',
    'Turkmen','Azerbaijani','Armenian','Georgian','Mongolian','Tibetan','Uyghur','Burmese','Khmer','Lao',
    'Telugu','Tamil','Malayalam','Kannada','Marathi','Gujarati','Odia','Assamese','Nepali','Sinhala','Tok Pisin'
  ]
};

///////////////////////
// Simple Analytics
///////////////////////
const ANALYTICS = {
  track(event, action, value = null) {
    const payload = {
      event, action, value,
      timestamp: Date.now(),
      userAgent: navigator.userAgent.substring(0, 80),
      url: location.href,
      referrer: document.referrer
    };
    try {
      const list = JSON.parse(localStorage.getItem('omni_analytics') || '[]');
      list.push(payload);
      localStorage.setItem('omni_analytics', JSON.stringify(list.slice(-50)));
      fetch(`${CONFIG.API_BASE_URL}/track-event`, {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(payload)
      }).catch(()=>{});
    } catch {}
  },
  conversion(stage, plan, amount = null) {
    this.track('conversion', stage, amount);
    console.log(`🎯 conversion: ${stage} (${plan})`);
  }
};

///////////////////////
// Auth & Access
///////////////////////
const FWEA_AUTH = {
  generateFingerprint() {
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    ctx.textBaseline = 'top';
    ctx.font = '14px Arial';
    ctx.fillText('FWEA Browser ID', 2, 2);
    return btoa(JSON.stringify({
      canvas: canvas.toDataURL().slice(-32),
      tz: Intl.DateTimeFormat().resolvedOptions().timeZone,
      lang: navigator.language,
      plat: navigator.platform,
      res: `${screen.width}x${screen.height}`,
      cores: navigator.hardwareConcurrency || 4,
      mem: navigator.deviceMemory || 4
    }));
  },
  encrypt(obj) { return btoa(JSON.stringify(obj) + '_fwea_secure'); },
  decrypt(str) {
    try { return JSON.parse(atob(str).replace('_fwea_secure','')); } catch { return null; }
  },
  fingerprintMatch(a,b){
    try{
      const A=JSON.parse(atob(a)),B=JSON.parse(atob(b));
      const score = [
        A.tz===B.tz, A.lang===B.lang, A.plat===B.plat, A.res===B.res,
        Math.abs((A.cores||0)-(B.cores||0))<=1,
        Math.abs((A.mem||0)-(B.mem||0))<=2
      ].filter(Boolean).length;
      return score>=4;
    }catch{return false;}
  },
  getPlanFeatures(plan){
    const map={
      free:{preview:30, full:false, quality:'preview'},
      single_track:{preview:30, full:true, quality:'hd'},
      day_pass:{preview:30, full:true, quality:'hd'},
      dj_pro:{preview:30, full:true, quality:'professional', batch:true},
      studio_elite:{preview:60, full:true, quality:'studio', batch:true, api:true}
    }; return map[plan]||map.free;
  },
  async activateSubscription(plan, sessionId, email=null){
    const fp = this.generateFingerprint();
    const data = { plan, sessionId, email, activated: Date.now(), fingerprint: fp };
    localStorage.setItem('fwea_access', this.encrypt(data));
    try{
      await fetch(`${CONFIG.API_BASE_URL}/activate-access`,{
        method:'POST', headers:{'Content-Type':'application/json'},
        body:JSON.stringify({ fingerprint:fp, plan, sessionId, email })
      });
      showSuccess(`🎉 ${plan.replace('_',' ').toUpperCase()} activated`);
      this.updateUIForPlan(plan);
      return true;
    }catch(e){ console.error(e); return false; }
  },
  async validateAccess(){
    const raw = localStorage.getItem('fwea_access');
    if(!raw) return {valid:false, plan:'free', reason:'none'};
    const local = this.decrypt(raw); if(!local) return {valid:false, plan:'free', reason:'corrupt'};
    // day pass expiry
    if(local.plan==='day_pass' && Date.now()-local.activated>24*60*60*1000){
      localStorage.removeItem('fwea_access');
      return {valid:false, plan:'free', reason:'expired'};
    }
    // device match
    const current = this.generateFingerprint();
    if(!this.fingerprintMatch(local.fingerprint,current)){
      localStorage.removeItem('fwea_access');
      return {valid:false, plan:'free', reason:'device_mismatch'};
    }
    // server validation for subs (not needed for single_track)
    if(['dj_pro','studio_elite','day_pass'].includes(local.plan)){
      try{
        const r = await fetch(`${CONFIG.API_BASE_URL}/validate-subscription`,{
          method:'POST', headers:{'Content-Type':'application/json'},
          body:JSON.stringify({ fingerprint:current, sessionId:local.sessionId, plan:local.plan })
        });
        const v = await r.json();
        if(!v.valid){ localStorage.removeItem('fwea_access'); return {valid:false, plan:'free', reason:'invalid'}; }
      }catch(e){ console.warn('offline subscription validation',e); }
    }
    return {valid:true, plan:local.plan, features:this.getPlanFeatures(local.plan), fingerprint:current, sessionId:local.sessionId};
  },
  updateUIForPlan(plan){
    let badge = document.getElementById('plan-badge');
    if(!badge){
      badge=document.createElement('div'); badge.id='plan-badge';
      badge.style.cssText='position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#00d4ff,#00ff88);color:#0a0a0a;padding:8px 16px;border-radius:20px;font-weight:700;font-size:12px;z-index:1000';
      document.body.appendChild(badge);
    }
    const names={single_track:'🎵 Single Track',day_pass:'⏰ Day Pass',dj_pro:'🎧 DJ Pro',studio_elite:'🏆 Studio Elite'};
    badge.textContent=names[plan]||'🆓 Free';
    if(plan!=='free'){
      const sub = document.querySelector('.upload-subtitle');
      if(sub) sub.textContent='Premium activated — drop a file for instant professional cleaning.';
    }
  }
};

///////////////////////
// Anti-piracy (light)
///////////////////////
const ANTI_PIRACY = {
  init(){
    // block right-click on player
    document.addEventListener('contextmenu', e=>{
      if(e.target.tagName==='AUDIO' || e.target.closest('.audio-player')){ e.preventDefault(); showNotification('💡 Upgrade for full downloads.'); }
    });
    // moving watermark while playing
    let timer=null;
    window.addEventListener('audio-play', ()=>{ timer=setInterval(()=>this.watermark(),3000); });
    window.addEventListener('audio-pause', ()=>{ if(timer) clearInterval(timer); });
  },
  watermark(){
    const w=document.createElement('div');
    w.textContent=`FWEA-I Preview • ${new Date().toISOString().slice(0,16)}`;
    w.style.cssText=`position:fixed;top:${10+Math.random()*70}%;left:${10+Math.random()*70}%;color:rgba(0,212,255,.45);font-weight:700;font-size:14px;pointer-events:none;z-index:9999;background:rgba(0,0,0,.3);padding:4px 12px;border-radius:12px;backdrop-filter:blur(5px);transform:rotate(${Math.random()*40-20}deg);animation:fadeInOut 4s ease-in-out`;
    document.body.appendChild(w); setTimeout(()=>w.remove(),4000);
  }
};

///////////////////////
// DOM References
///////////////////////
const el = {
  uploadArea: null,
  fileInput: null,
  processing: null,
  processingStatus: null,
  progressFill: null,
  progressLine: null,
  progressPct: null,
  timeRemaining: null,
  detectedLanguages: null,
  audioPlayer: null,
  player: null,
  playBtn: null,
  timeDisplay: null,
  wordsRemoved: null,
  languagesDetected: null,
  pricing: null,
};

///////////////////////
// State
///////////////////////
let currentFile = null;
let isProcessing = false;
let stripe = null;
let accessState = { valid:false, plan:'free' };

///////////////////////
// Init
///////////////////////
document.addEventListener('DOMContentLoaded', async () => {
  stripe = Stripe(CONFIG.STRIPE_PUBLISHABLE_KEY);

  // bind DOM
  el.uploadArea = document.getElementById('uploadArea');
  el.fileInput = document.getElementById('fileInput');
  el.processing = document.getElementById('processingSection');
  el.processingStatus = document.getElementById('processingStatus');
  el.progressFill = document.getElementById('progressFill');
  el.progressLine = document.getElementById('progressLine');
  el.progressPct = document.getElementById('progressPercentage');
  el.timeRemaining = document.getElementById('timeRemaining');
  el.detectedLanguages = document.getElementById('detectedLanguages');
  el.audioPlayer = document.getElementById('audioPlayer');
  el.player = document.getElementById('player');
  el.playBtn = document.getElementById('playBtn');
  el.timeDisplay = document.getElementById('timeDisplay');
  el.wordsRemoved = document.getElementById('wordsRemoved');
  el.languagesDetected = document.getElementById('languagesDetected');
  el.pricing = document.getElementById('pricing');

  // listeners
  el.fileInput.addEventListener('change', onFileSelect);
  el.uploadArea.addEventListener('dragover', e=>{e.preventDefault(); el.uploadArea.classList.add('drag-over');});
  el.uploadArea.addEventListener('dragleave', e=>{e.preventDefault(); el.uploadArea.classList.remove('drag-over');});
  el.uploadArea.addEventListener('drop', onDrop);
  el.playBtn.addEventListener('click', togglePlayback);
  el.player.addEventListener('timeupdate', syncPlayerTime);
  el.player.addEventListener('ended', ()=>{ el.playBtn.textContent='▶️'; window.dispatchEvent(new Event('audio-pause')); });

  // language banner
  const lane = document.getElementById('languageScroll');
  if(lane){ lane.innerHTML = [...CONFIG.LANGUAGES, ...CONFIG.LANGUAGES].map(l=>`<span class="language-item">${l}</span>`).join(''); }

  // anti-piracy
  ANTI_PIRACY.init();

  // access
  accessState = await FWEA_AUTH.validateAccess();
  if(accessState.valid && accessState.plan!=='free'){ FWEA_AUTH.updateUIForPlan(accessState.plan); showSuccess(`Welcome back — ${accessState.plan.toUpperCase()} active.`); }

  ANALYTICS.track('page_view','loaded');
});

///////////////////////
// Upload + Process
///////////////////////
function onDrop(e){
  e.preventDefault(); el.uploadArea.classList.remove('drag-over');
  const f = [...e.dataTransfer.files].find(f=>f.type.startsWith('audio/'));
  if(!f) return showError('Please drop a valid audio file.');
  processFile(f);
}
function onFileSelect(e){
  const f = e.target.files[0];
  if(f) processFile(f);
}

function validateFile(file){
  if(file.size>CONFIG.MAX_FILE_SIZE){ showError(`File too large. Max ${(CONFIG.MAX_FILE_SIZE/(1024*1024)).toFixed(0)}MB`); return false; }
  const ext = (file.name.split('.').pop()||'').toLowerCase();
  if(!CONFIG.SUPPORTED_FORMATS.includes(ext)){ showError(`Unsupported format. Use: ${CONFIG.SUPPORTED_FORMATS.join(', ')}`); return false; }
  return true;
}

async function processFile(file){
  if(isProcessing) return showError('Please wait for current processing to finish.');
  if(!validateFile(file)) return;

  currentFile = file;
  ANALYTICS.track('user_action','file_uploaded', file.size);

  // UI: show processing pane
  isProcessing = true;
  el.processing.style.display='block';
  document.querySelector('.upload-section').style.display='none';
  resetProgress();
  progressiveStages();

  // figure plan + fingerprint
  const fp = FWEA_AUTH.generateFingerprint();
  const plan = accessState?.plan || 'free';

  try{
    const fd = new FormData();
    fd.append('audio', file);        // MUST match Worker
    fd.append('fingerprint', fp);
    fd.append('planType', plan);

    const res = await fetch(`${CONFIG.API_BASE_URL}/process-audio`, { method:'POST', body: fd });
    const json = await res.json();
    if(!res.ok || !json.success) throw new Error(json?.error || 'Processing failed');

    // fill UI from backend response
    // expects: previewUrl, fullAudioUrl, detectedLanguages, wordsRemoved, previewDuration
    if(Array.isArray(json.detectedLanguages)){
      el.detectedLanguages.innerHTML = '';
      json.detectedLanguages.forEach((lang,i)=>{
        const tag = document.createElement('span');
        tag.className='language-tag'; tag.textContent=lang;
        setTimeout(()=>el.detectedLanguages.appendChild(tag), i*150);
      });
    }
    el.wordsRemoved.textContent = json.wordsRemoved ?? 0;
    el.languagesDetected.textContent = Array.isArray(json.detectedLanguages) ? json.detectedLanguages.length : 1;

    // ready player
    el.player.src = json.previewUrl;
    el.player.style.display = 'block';

    // finish progress & reveal player
    finishProgress().then(()=>completeProcessing());

    // store full url in memory (not exposed in DOM)
    window.__fweaPreviewUrl = json.previewUrl;
    window.__fweaFullUrl = json.fullAudioUrl || null;

    ANALYTICS.conversion('preview_completed', plan);
  }catch(err){
    console.error(err);
    showError('⚠️ Audio processing failed. Please try again.');
    isProcessing=false;
    el.processing.style.display='none';
    document.querySelector('.upload-section').style.display='block';
  }
}

function resetProgress(){
  setProgress(0);
  el.processingStatus.textContent = 'Initializing AI engine...';
  el.detectedLanguages.innerHTML='';
  ['stage1','stage2','stage3','stage4','stage5'].forEach(id=>{
    const s = document.getElementById(id);
    s?.classList.remove('active'); s?.classList.remove('completed');
  });
}

function setProgress(p){
  const val = Math.max(0, Math.min(100, p));
  el.progressFill.style.width = val+'%';
  el.progressLine.style.width = val+'%';
  el.progressPct.textContent = `${Math.round(val)}%`;
  const eta = Math.max(1, Math.ceil((100-val)*0.02));
  el.timeRemaining.textContent = `Estimated time: ${eta} seconds`;
}

async function progressiveStages(){
  const stages = [
    { id:'stage1', text:'Analyzing audio waveform and structure...', dur: 1200 },
    { id:'stage2', text:'Detecting languages using AI models...', dur: 900 },
    { id:'stage3', text:'Identifying and mapping inappropriate content...', dur: 1500 },
    { id:'stage4', text:'Reconstructing clean audio segments...', dur: 1300 },
    { id:'stage5', text:'Enhancing quality and finalizing output...', dur: 800 }
  ];
  let acc=0;
  for(const s of stages){
    el.processingStatus.textContent = s.text;
    document.getElementById(s.id)?.classList.add('active');
    await animate(acc, acc+20, s.dur);
    document.getElementById(s.id)?.classList.remove('active');
    document.getElementById(s.id)?.classList.add('completed');
    acc += 20;
  }
}
function animate(from,to,dur){
  return new Promise(res=>{
    const start=Date.now();
    const tick=()=>{
      const t=(Date.now()-start)/dur;
      const p = from + (to-from)*Math.min(1,t);
      setProgress(p);
      if(t<1) requestAnimationFrame(tick); else res();
    };
    tick();
  });
}
function finishProgress(){ return animate(parseFloat(el.progressPct.textContent)||80, 100, 600); }

function completeProcessing(){
  isProcessing=false;
  el.processing.style.display='none';
  el.audioPlayer.style.display='block';
  el.audioPlayer.classList.add('fade-in');
}

///////////////////////
// Player
///////////////////////
function togglePlayback(){
  if(!el.player.src) return;
  if(el.player.paused){
    el.player.play(); el.playBtn.textContent='⏸️'; window.dispatchEvent(new Event('audio-play'));
  }else{
    el.player.pause(); el.playBtn.textContent='▶️'; window.dispatchEvent(new Event('audio-pause'));
  }
}
function syncPlayerTime(){
  const cur = Math.floor(el.player.currentTime||0);
  const dur = Math.floor(el.player.duration|| (accessState.plan==='studio_elite'?CONFIG.STUDIO_PREVIEW_DURATION:CONFIG.PREVIEW_DURATION));
  el.timeDisplay.textContent = `${formatTime(cur)} / ${formatTime(dur)}`;
}
function formatTime(s){ const m=Math.floor(s/60), ss=(s%60).toString().padStart(2,'0'); return `${m}:${ss}`; }

///////////////////////
// Pricing / Stripe
///////////////////////
async function startCheckout(type, priceId, amount){
  if(document.body.classList.contains('admin-mode')){ showSuccess('Admin: full access granted.'); return; }
  ANALYTICS.conversion('checkout_started', type, amount);
  try{
    const fp = FWEA_AUTH.generateFingerprint();
    const email = null; // optional: collect via modal if you want prefill
    const r = await fetch(`${CONFIG.API_BASE_URL}/create-payment`,{
      method:'POST', headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ priceId, type, fileName: currentFile?.name || 'audio_track', email, fingerprint: fp })
    });
    const j = await r.json();
    if(!r.ok) throw new Error(j?.error || 'Payment error');
    await stripe.redirectToCheckout({ sessionId: j.sessionId });
  }catch(e){
    console.error(e);
    showError('Payment processing failed. Please try again.');
  }
}

async function purchaseTrack(){ startCheckout('single_track', CONFIG.STRIPE_PRICES.SINGLE_TRACK, 4.99); }
async function purchaseDayPass(){ startCheckout('day_pass', CONFIG.STRIPE_PRICES.DAY_PASS, 9.99); }
async function purchaseDJPro(){ startCheckout('dj_pro', CONFIG.STRIPE_PRICES.DJ_PRO, 29.99); }
async function purchaseStudioElite(){ startCheckout('studio_elite', CONFIG.STRIPE_PRICES.STUDIO_ELITE, 99.99); }

// expose for buttons
window.purchaseTrack = purchaseTrack;
window.purchaseDayPass = purchaseDayPass;
window.purchaseDJPro = purchaseDJPro;
window.purchaseStudioElite = purchaseStudioElite;

///////////////////////
// UI helpers
///////////////////////
function showPricingModal(){ document.getElementById('pricing').scrollIntoView({behavior:'smooth'}); ANALYTICS.conversion('pricing_viewed','free'); }
function downloadPreview(){
  if(!window.__fweaPreviewUrl){ return showError('No preview available yet.'); }
  const a = document.createElement('a'); a.href = window.__fweaPreviewUrl; a.download = (currentFile?.name || 'preview') + '.mp3'; document.body.appendChild(a); a.click(); a.remove();
  showSuccess('Preview download started.'); ANALYTICS.conversion('preview_download','free');
}
window.showPricingModal = showPricingModal;
window.downloadPreview = downloadPreview;

function showError(msg){ notify(msg,'error'); }
function showSuccess(msg){ notify(msg,'success'); }
function showWarning(msg){ notify(msg,'warning'); }
function showNotification(msg){ notify(msg,'info'); }
function notify(message, type){
  const colors={ error:'rgba(255,68,68,.95)', success:'rgba(0,255,136,.95)', warning:'rgba(255,165,0,.95)', info:'rgba(0,212,255,.95)' };
  const n=document.createElement('div');
  n.style.cssText=`position:fixed;top:20px;right:20px;padding:16px 24px;background:${colors[type]};color:#fff;border-radius:12px;font-weight:700;z-index:1000;backdrop-filter:blur(10px);animation:slideInRight .3s ease;max-width:420px;`;
  n.textContent=message; document.body.appendChild(n); setTimeout(()=>n.remove(), 5000);
}

///////////////////////
// Admin mode flag
///////////////////////
(function checkAdmin(){
  const isAdmin = location.search.includes('admin=true') || localStorage.getItem('fwea_admin')==='true';
  if(isAdmin){ document.body.classList.add('admin-mode'); console.log('Admin mode active'); }
})();

// minimal global to satisfy any external callbacks
window.FWEA_AUTH = FWEA_AUTH;
  </script>
</body>
</html>
